<head>
	<link rel="stylesheet" type="text/css" href="/styles.css">
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/img/favicon.ico" type="image/x-icon">
	<title>Eutopía - Ecovillage</title>

		<script type="text/javascript" src="/js/common-admin.js"></script>

	<script type="text/javascript">
		window.SERVER={
			API_URL: 'https://utopiaecoaldea.herokuapp.com'
		}
	</script>
</head>
<body>

	

		<section class="admin_header">
	        <h3 class="brand">
	        <a href="/">Eutopía - Ecovillage</a>
	         - Admin</h3>
	        <hr>
	    </section>

	<div class="mainContent">
		<section class="admin protected">
		    <section class="admin_menu">
		        <a href="#">General: Subir imagenes</a>
		        <section class="upload-images">
		            <input type="file" name="image" id="image"/>
		            <button @click="uploadImage()" v-html="uploading?'Wait':'Upload'"></button>
		        </section>
		        <a href="#">General: Ver imagenes</a>
		        <section class="view-images imagesViewBox">
		            <div v-for="item in images">
		                <div class="admin-image-thumb" 
		                :style="`background-image:url(/uploads/images/${item});`">
		                </div>
		                <input :value="`/uploads/images/${item}`" class="imageUrl"/>
		            </div>
		        </section>
		        <a href="#">Hospedajes: Titulo: Color</a>
		        <a href="#">Hospedajes: Titulo: Texto</a>
		        <a href="#">Hospedajes: Titulo: Imagen</a>
		        <a href="#" onclick="logout()" class="logout">Salir</a>
		        <hr>
		    </section>
		</section>	</div>

	<!--

	<section class="common_sections">
		<section class="team">
			<h2 class="title">Sobre nosotros</h2>
			<article>
				<p class="text">Lorem ipsum team. Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.</p>
			</article>
		</section>
		<section class="contact">
			<h2 class="title">Contacto</h2>
			<article>
				<p class="text">Lorem ipsum team. Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.</p>
			</article>
		</section>
		<section class="volunteers">
			<h2 class="title">Voluntariado</h2>
			<article>
				<p class="text">Lorem ipsum team. Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.</p>
			</article>
		</section>
		<section class="legalMentions">
			<h2 class="title">Menciones legales</h2>
			<article>
				<p class="text">Lorem ipsum team. Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.</p>
			</article>
		</section>

		<section class="hospedajesCamping">
			<h2 class="title">Hospedajes: Camping</h2>
			<article>
				<p class="text">Lorem ipsum team. Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.Lorem ipsum team.</p>
			</article>
		</section>
	</section>

-->

	

	<script type="text/javascript" src="/libs/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="/libs/vue.js"></script>
	<!--
	<script type="text/javascript" src="/bundle.js"></script>
-->
	<script type="text/javascript">
			function init() {
				new Vue({
					el: '.admin',
					name: 'admin_dashboard',
					data() {
						return {
							uploading:false,
							single_image:null,
							images:[]
						}
					},
					created() {
						console.log('admin_dashboard')
					},
					mounted(){
						this.browseImages();
					},
					methods: {
						uploadImage,
						browseImages
					}
				})

				function browseImages(){
					fetch(`${SERVER.API_URL}/api/images/browse`).then(r => r.json().then(response => {
						this.images = response.images;
					}));
				}

				function uploadImage() {
					var data = new FormData();
					var file = $('#image')[0].files[0];
					data.append('image', file);
					this.uploading=true;
					$.ajax({
						url: `${SERVER.API_URL}/api/upload/images/single`,
						data: data,
						cache: false,
						contentType: false,
						processData: false,
						type: 'POST',
						error:()=>{
							this.uploading=false;
							$('#image').val('');
						},
						success: (data)=>{
							this.uploading=false;
							$('#image').val('');
							alert('Image uploaded!')
						}
					});
				}
			}
			if(!!init){
				init();
			}
	</script>
</body>